<!doctype html>
<html>

<head>
{{ partial "head.html" . }}
</head>

<body class="mx-auto w-full p-2">
  <h2 class="font-ibm-mono font-medium my-3 text-center text-xl" id="demo"></h2>

  <script>
    var comotURL = new URL(window.location);
    var grupParams = comotURL.searchParams.get('group');
    var mothParams = comotURL.searchParams.get('ket');
    document.getElementById('demo').innerHTML = '@' + grupParams + ' ' + mothParams;
    </script>
    <div id="teleget" class="w-full"></div>
    <script>
      (function() {
        var container = document.getElementById('teleget')
            
        var pageUrl = new URL(window.location);
        var groupParams = pageUrl.searchParams.get('group');
    
        var embedChat = function(chatIndex) {
          var quote = document.createElement('blockquote');
          quote.classList.add('telegram-post');
          quote.dataset.telegramPost = `${groupParams}/${chatIndex}`;
          quote.dataset.width = '100%';
            
          container.appendChild(quote);
        };
        
        var insertJs = function() {
          var script = document.createElement('script');
          script.src = 'https://telegram.org/js/telegram-widget.js?22';
          script.setAttribute('async', '');
          
          document.body.appendChild(script);
        };
        
        var fromParams = pageUrl.searchParams.get('from');
        var toParams = pageUrl.searchParams.get('to');
        var chatIndexesParams = pageUrl.searchParams.get('chatIndexes');
        
        
        if (groupParams && fromParams && toParams) {
          var from = parseInt(fromParams);
          var to = parseInt(toParams);
          
          for (var chatIndex = from; chatIndex <= to; chatIndex++) {
            embedChat(chatIndex);
          }
          insertJs();
        } else if (groupParams && chatIndexesParams) {
          var chatIndexes = chatIndexesParams.split(',');
          for (var chatIndex of chatIndexes) {
            embedChat(chatIndex.trim());
          }
          insertJs();
        } else {
          container.innerHTML = ' ';
        }
    })();
      </script>

</body>
</html>
